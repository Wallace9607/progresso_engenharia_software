<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gerador Autom√°tico de TCC ‚Äî ABNT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- ===== ESTILO ===== -->
<style>
  :root{
    --bg:#0b1120;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --accent:#2563eb;
  }

  body{
    margin:0;
    padding:0;
    font-family:Arial, Helvetica, sans-serif;
    background:var(--bg);
    color:var(--text);
  }

  .container{
    max-width:900px;
    margin:40px auto;
    padding:20px;
  }

  .btn{
    background:var(--accent);
    color:#fff;
    padding:10px 18px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    transition:.2s;
  }
  .btn:hover{ opacity:.8; }

  .card{
    background:#fff;
    color:#000;
    padding:40px;
    border-radius:12px;
    margin-top:25px;
    line-height:1.8;
    font-size:15px;
  }

  h1,h2,h3{ margin:0 0 10px 0; }
  #tccViewer h2{ margin-top:28px; font-size:20px; }
</style>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

</head>
<body>

<div class="container">
  <h1>üìö Gerador Autom√°tico de TCC (ABNT)</h1>
  <p style="color:var(--muted)">Seu TCC completo √© gerado automaticamente com os dados do painel.</p>

  <div style="margin-top:20px; display:flex; gap:12px; flex-wrap:wrap">
    <button id="gerarTCC" class="btn">Gerar TCC</button>
    <button id="editarTCC" class="btn" style="display:none">Editar Manualmente</button>
    <button id="salvarTCC" class="btn" style="display:none">Salvar Vers√£o</button>
    <button id="exportarPDF" class="btn" style="display:none">Exportar PDF</button>
  </div>

  <div id="tccViewer" class="card" style="display:none;">
    <div id="tccContent" contenteditable="false"></div>
  </div>
</div>

<!-- ============ COLETA DE DADOS DO SISTEMA =============== -->
<script>
function coletarDadosSistema(){
  return {
    disciplinas: JSON.parse(localStorage.getItem("disciplinas") || "{}"),
    estadoCurso: JSON.parse(localStorage.getItem("es_course_state_v1") || "{}"),
    biblioteca: JSON.parse(localStorage.getItem("biblioteca_lista") || "[]"),
    calendario: JSON.parse(localStorage.getItem("calendario_academico") || "[]"),
    cursosExtras: JSON.parse(localStorage.getItem("cursos_extra_progresso") || "[]"),
    metas: JSON.parse(localStorage.getItem("metas_semana") || "[]"),
    tempoEstudo: localStorage.getItem("tempo_estudo") || "0",

    // disciplina_<nome> (futuro)
    pegarDisciplinasIndividuais: () => {
      const chaves = Object.keys(localStorage).filter(k => k.startsWith("disciplina_"));
      return chaves.map(k => JSON.parse(localStorage.getItem(k)));
    }
  };
}
</script>

<!-- ============ MODELO ABNT =============== -->
<script>
function modeloABNT(d){

const disciplinasLista = Object.values(d.disciplinas).map(x=>x.nome).join(", ");

return `

<h1 style="text-align:center; margin-top:200px;">
  PROJETO DE TCC ‚Äî ENGENHARIA DE SOFTWARE
</h1>

<div style="page-break-after:always;"></div>

<h1 style="text-align:center; margin-top:200px;">
  ${disciplinasLista ? "Aprendizagem Acad√™mica ao Longo da Forma√ß√£o em Engenharia de Software" : "Trabalho de Conclus√£o de Curso"}
</h1>

<div style="page-break-after:always;"></div>

<h2>Resumo</h2>
<p>
  Este trabalho apresenta uma s√≠ntese do processo de aprendizagem desenvolvido ao longo do curso de Engenharia de Software.
  Com base nos registros do ambiente acad√™mico, analisam-se as disciplinas estudadas, conte√∫dos abordados, materiais utilizados e evolu√ß√£o
  acad√™mica registrada no sistema. O estudo busca consolidar o conhecimento adquirido e organizar uma vis√£o metodol√≥gica e coerente do percurso formativo.
</p>

<h2>1. Introdu√ß√£o</h2>
<p>
  Este Trabalho de Conclus√£o de Curso tem como finalidade documentar o desenvolvimento do estudante ao longo da forma√ß√£o em Engenharia de Software.
  As disciplinas estudadas incluem ${disciplinasLista}. O progresso registrado demonstra uma evolu√ß√£o cont√≠nua dos conhecimentos te√≥ricos
  e pr√°ticos necess√°rios para atua√ß√£o profissional na √°rea.
</p>

<h2>2. Problema</h2>
<p>
  Como consolidar, estruturar e apresentar de forma acad√™mica todo o conte√∫do aprendido durante a forma√ß√£o, garantindo uma vis√£o clara, organizada
  e metodol√≥gica do progresso t√©cnico e te√≥rico obtido ao longo do curso?
</p>

<h2>3. Justificativa</h2>
<p>
  A justificativa para este trabalho reside na necessidade de organiza√ß√£o e sistematiza√ß√£o do conhecimento adquirido, permitindo uma avalia√ß√£o
  completa da forma√ß√£o e a constru√ß√£o de um documento formal que demonstre a evolu√ß√£o acad√™mica dentro dos padr√µes da ABNT.
</p>

<h2>4. Objetivo Geral</h2>
<p>
  Consolidar e apresentar, em formato de TCC, todo o conhecimento adquirido durante a forma√ß√£o em Engenharia de Software.
</p>

<h2>5. Objetivos Espec√≠ficos</h2>
<p>
  ‚Ä¢ Descrever as disciplinas cursadas e seus principais conte√∫dos;<br>
  ‚Ä¢ Analisar o desenvolvimento acad√™mico por meio dos registros de progresso;<br>
  ‚Ä¢ Demonstrar evolu√ß√£o t√©cnica em √°reas essenciais da Engenharia de Software;<br>
  ‚Ä¢ Relacionar materiais estudados e fundamentos te√≥ricos utilizados;<br>
  ‚Ä¢ Apresentar uma s√≠ntese metodol√≥gica das pr√°ticas de estudo adotadas.
</p>

<h2>6. Fundamenta√ß√£o Te√≥rica</h2>
<p>
  A fundamenta√ß√£o te√≥rica baseia-se nos materiais estudados inclu√≠dos na biblioteca acad√™mica, tais como artigos, livros e conte√∫dos digitais.
</p>
${d.biblioteca.map(item => `
<p><strong>${item.titulo}</strong> ‚Äî ${item.descricao || ""}</p>
`).join("")}

<h2>7. Metodologia</h2>
<p>
  A metodologia utilizada constitui-se de estudo cont√≠nuo, leitura de materiais, execu√ß√£o de atividades pr√°ticas e acompanhamento das disciplinas.
  Os dados utilizados neste TCC foram extra√≠dos automaticamente do sistema de acompanhamento acad√™mico.
</p>

<h2>8. Desenvolvimento</h2>
<p>
  O desenvolvimento do estudo considerou o andamento das disciplinas registradas e o progresso individual do aluno.
</p>
${Object.values(d.disciplinas).map(mat => `
  <h3>${mat.nome}</h3>
  <p>Progresso: ${mat.porcentagem || 0}%</p>
`).join("")}

<h2>9. Resultados</h2>
<p>
  O aluno registrou um total de ${d.tempoEstudo} horas de estudo e evoluiu academicamente conforme os indicadores do sistema.
  O progresso geral demonstra consolida√ß√£o progressiva das habilidades essenciais do curso.
</p>

<h2>10. Considera√ß√µes Finais</h2>
<p>
  Conclui-se que o acompanhamento sistematizado do desenvolvimento acad√™mico permitiu identificar a evolu√ß√£o do estudante ao longo da forma√ß√£o.
  O presente TCC re√∫ne e estrutura esse conhecimento, demonstrando a trajet√≥ria de aprendizagem de forma formal e organizada.
</p>

<h2>Refer√™ncias</h2>
<p>
  Pressman, R. Engenharia de Software.<br>
  Sommerville, I. Engenharia de Software.<br>
  Materiais complementares registrados no sistema acad√™mico.
</p>

`;
}
</script>

<!-- ============ SCRIPT PRINCIPAL =============== -->
<script>
document.getElementById("gerarTCC").onclick = () => {
  const dados = coletarDadosSistema();
  const html = modeloABNT(dados);

  const viewer = document.getElementById("tccViewer");
  const content = document.getElementById("tccContent");

  content.innerHTML = html;
  viewer.style.display = "block";

  document.getElementById("editarTCC").style.display = "inline-block";
  document.getElementById("salvarTCC").style.display = "inline-block";
  document.getElementById("exportarPDF").style.display = "inline-block";
};

document.getElementById("editarTCC").onclick = () => {
  document.getElementById("tccContent").contentEditable = true;
  alert("Agora voc√™ pode editar seu TCC manualmente.");
};

document.getElementById("salvarTCC").onclick = () => {
  const texto = document.getElementById("tccContent").innerHTML;
  localStorage.setItem("tcc_gerado_abnt", texto);
  alert("TCC salvo com sucesso!");
};

document.getElementById("exportarPDF").onclick = () => {
  const el = document.getElementById("tccViewer");
  html2pdf().set({
    margin: 1,
    filename: "TCC_ABNT.pdf",
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
  }).from(el).save();
};
</script>

</body>
</html>
